(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[757],{1166:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9687).A)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},2203:(e,t,r)=>{"use strict";let a;r.d(t,{A:()=>i,O:()=>l});var s=r(7620);try{a=r(122)}catch(e){a={}}function i(){let e=null,t=null,r=null,i=null;try{a.useSignIn&&(e=a.useSignIn()),a.useSignOut&&(t=a.useSignOut()),a.useAuthUser&&(r=a.useAuthUser()),a.useIsAuthenticated&&(i=a.useIsAuthenticated())}catch(e){console.error("Error initializing react-auth-kit hooks",e)}let[l,c]=(0,s.useState)(null),[n,d]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=()=>{let e=(()=>{try{if(r&&"function"==typeof r)return r();{let e=localStorage.getItem("campusride_access_token");if(e)try{let t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(t).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join("")),a=JSON.parse(r);return{id:a.id,email:a.email,first_name:"",last_name:"",user_type:a.user_type}}catch(e){}}}catch(e){console.error("Error getting user",e)}return null})(),t=(()=>{try{if(i&&"function"==typeof i)return i();return!!localStorage.getItem("campusride_access_token")}catch(e){console.error("Error checking authentication",e)}return!1})();c(e),d(t)};e();let t=setInterval(e,2e3),a=()=>{e()};return window.addEventListener("storage",a),()=>{clearInterval(t),window.removeEventListener("storage",a)}},[r,i]),{user:l,isAuthenticated:n,isLoading:!1,login:(t,r,a)=>{localStorage.setItem("campusride_access_token",t),r&&localStorage.setItem("campusride_refresh_token",r);let s=a||null;if(!s)try{let e=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(e).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join("")),a=JSON.parse(r);s={id:a.id,email:a.email,first_name:"",last_name:"",user_type:a.user_type}}catch(e){console.error("Failed to decode token",e);return}if(e&&"function"==typeof e)try{e({token:t,expiresIn:604800,tokenType:"Bearer",authState:s})&&(c(s),d(!0))}catch(e){console.error("Failed to sign in with react-auth-kit",e)}else c(s),d(!0)},logout:()=>{if(localStorage.removeItem("campusride_access_token"),localStorage.removeItem("campusride_refresh_token"),t&&"function"==typeof t)try{t()}catch(e){console.error("Failed to sign out with react-auth-kit",e)}c(null),d(!1)},refreshUser:async()=>Promise.resolve()}}let l=a.AuthProvider||(e=>e.children)},2323:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>v});var a=r(4568),s=r(7620),i=r(7541),l=r(9664),c=r.n(l),n=r(8653),d=r(4751),o=r(2744),x=r(1166),m=r(9769),h=r(6840),u=r(6178),g=r(2340),p=r(2883),y=r(2203);function f(){let e=(0,i.useSearchParams)();(0,i.useRouter)();let{user:t}=(0,y.A)(),r=e.get("id"),[l,f]=(0,s.useState)(null),[v,k]=(0,s.useState)(!0),[b,j]=(0,s.useState)("");async function N(){if(r)try{let e=await p.Ay.get("/rides/".concat(r));f(e.data)}catch(r){var e,t;j((null==(t=r.response)||null==(e=t.data)?void 0:e.detail)||r.message||"Failed to load ride status")}finally{k(!1)}}return((0,s.useEffect)(()=>{if(!r){j("No ride ID provided"),k(!1);return}N();let e=setInterval(N,1e4);return()=>clearInterval(e)},[r]),v)?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("div",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Loading ride status..."})})}):b||!l?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-black",children:[(0,a.jsx)("nav",{className:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,a.jsx)(c(),{href:"/",className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Campus Ride"})})}),(0,a.jsx)("div",{className:"container mx-auto px-4 py-8 max-w-2xl",children:(0,a.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6",children:[(0,a.jsx)(n.A,{className:"w-8 h-8 text-red-600 mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-red-900 dark:text-red-400 mb-2",children:b||"Ride not found"}),(0,a.jsxs)(c(),{href:"/history",className:"inline-flex items-center gap-2 text-red-700 dark:text-red-400 hover:underline",children:[(0,a.jsx)(d.A,{className:"w-4 h-4"}),"Back to History"]})]})})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-black",children:[(0,a.jsx)("nav",{className:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(c(),{href:"/",className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Campus Ride"}),(0,a.jsx)(c(),{href:"/history",className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:"Back to History"})]})})}),(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[(0,a.jsx)("div",{className:"".concat((()=>{if(!l)return"bg-gray-100";switch(l.status){case"completed":return"bg-green-100 dark:bg-green-900/20";case"cancelled":return"bg-red-100 dark:bg-red-900/20";case"in_progress":case"accepted":return"bg-blue-100 dark:bg-blue-900/20";default:return"bg-yellow-100 dark:bg-yellow-900/20"}})()," rounded-2xl p-6 mb-6"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:(()=>{if(!l)return"Loading...";switch(l.status){case"pending":return"Waiting for driver to accept...";case"accepted":return"Driver is on the way to pickup";case"in_progress":return"Ride in progress";case"completed":return"Ride completed";case"cancelled":return"Ride cancelled";default:return"Unknown status"}})()}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Ride ID: ",l.id]})]}),"completed"===l.status&&(0,a.jsx)(o.A,{className:"w-12 h-12 text-green-600"})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"md:col-span-2 bg-white dark:bg-gray-900 rounded-2xl shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-6",children:"Ride Details"}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)(x.A,{className:"w-6 h-6 text-blue-600 mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Pickup"}),(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:l.pickup_location})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)(x.A,{className:"w-6 h-6 text-green-600 mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Destination"}),(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:l.dropoff_location})]})]}),l.fare&&(0,a.jsx)("div",{className:"pt-6 border-t border-gray-200 dark:border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Fare"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["GHS ",l.fare.toFixed(2)]})]})})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-6",children:l.driver_id?"Your Driver":"Waiting"}),l.driver_id&&l.driver_info?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Driver Name"}),(0,a.jsxs)("div",{className:"font-medium text-gray-900 dark:text-white flex items-center gap-2",children:[(0,a.jsx)(m.A,{className:"w-4 h-4"}),l.driver_info.first_name," ",l.driver_info.last_name||"Driver"]})]}),l.driver_info.vehicle_model&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Vehicle"}),(0,a.jsxs)("div",{className:"font-medium text-gray-900 dark:text-white flex items-center gap-2",children:[(0,a.jsx)(h.A,{className:"w-4 h-4"}),l.driver_info.vehicle_model," ",l.driver_info.vehicle_plate?"(".concat(l.driver_info.vehicle_plate,")"):""]})]}),l.driver_info.phone&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Contact"}),(0,a.jsxs)("a",{href:"tel:".concat(l.driver_info.phone),className:"flex items-center gap-2 text-blue-600 dark:text-blue-400 hover:underline",children:[(0,a.jsx)(u.A,{className:"w-4 h-4"}),l.driver_info.phone]})]}),"in_progress"===l.status||"accepted"===l.status?(0,a.jsx)("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-blue-600 dark:text-blue-400",children:[(0,a.jsx)(h.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"font-semibold",children:"Driver on the way"})]})}):null]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(h.A,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Waiting for driver to accept..."})]})]})]}),("in_progress"===l.status||"accepted"===l.status)&&(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-lg p-6 mb-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,a.jsxs)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,a.jsx)(g.A,{className:"w-5 h-5"}),"Live Tracking"]})}),(0,a.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-xl h-64 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(x.A,{className:"w-12 h-12 mx-auto mb-2 text-gray-400"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Map view would be displayed here"})]})})]}),"completed"!==l.status&&"cancelled"!==l.status&&(0,a.jsx)("div",{className:"flex gap-4",children:(0,a.jsx)(c(),{href:"/history",className:"flex-1 px-6 py-3 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white font-medium rounded-xl hover:bg-gray-200 dark:hover:bg-gray-700 text-center transition-colors",children:"View All Rides"})}),"completed"===l.status&&(0,a.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)(o.A,{className:"w-6 h-6 text-green-600"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-green-900 dark:text-green-400",children:"Ride Completed Successfully!"})]}),(0,a.jsx)("p",{className:"text-green-800 dark:text-green-300 mb-4",children:"Thank you for using Campus Ride. We hope you had a great experience!"}),(0,a.jsx)(c(),{href:"/history",className:"inline-flex items-center gap-2 px-6 py-3 bg-green-600 text-white font-medium rounded-xl hover:bg-green-700 transition-colors",children:"View Ride History"})]})]})]})}function v(){return(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("div",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Loading..."})})}),children:(0,a.jsx)(f,{})})}},2340:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9687).A)("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]])},2744:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9687).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},2867:(e,t,r)=>{Promise.resolve().then(r.bind(r,2323))},2883:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>n,Rz:()=>l,c4:()=>i,pq:()=>c});var a=r(1208);let s=a.A.create({baseURL:"/api",headers:{"Content-Type":"application/json"},withCredentials:!0});function i(){return localStorage.getItem("campusride_access_token")}function l(e,t){localStorage.setItem("campusride_access_token",e),t&&localStorage.setItem("campusride_refresh_token",t)}s.interceptors.request.use(e=>{if(e.url&&e.url.startsWith("http")){let t=new URL(e.url);e.url=t.pathname}e.baseURL="/api";let t=i();return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,e=>{var t;return(null==(t=e.response)?void 0:t.status)===401&&(localStorage.removeItem("campusride_access_token"),localStorage.removeItem("campusride_refresh_token"),window.location.href="/auth/login"),Promise.reject(e)});let c={login:async(e,t)=>{let r=window.location.origin,s="".concat(r,"/api/auth/login");console.log("\uD83D\uDD35 Login API URL:",s),console.log("\uD83D\uDD35 Current origin:",r);let i=await a.A.post(s,{email:e,password:t},{headers:{"Content-Type":"application/json"}});return{access:i.data.access,refresh:i.data.refresh,user:i.data.user||{}}},register:async e=>{let t=window.location.origin;return(await a.A.post("".concat(t,"/api/auth/register"),e,{headers:{"Content-Type":"application/json"}})).data}},n=s},4751:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9687).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6178:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9687).A)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},6840:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9687).A)("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]])},8653:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9687).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},9687:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var a=r(7620);let s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:l=24,strokeWidth:c=2,absoluteStrokeWidth:n,className:d="",children:o,iconNode:x,...m}=e;return(0,a.createElement)("svg",{ref:t,...i,width:l,height:l,stroke:r,strokeWidth:n?24*Number(c)/Number(l):c,className:s("lucide",d),...m},[...x.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(o)?o:[o]])}),c=(e,t)=>{let r=(0,a.forwardRef)((r,i)=>{let{className:c,...n}=r;return(0,a.createElement)(l,{ref:i,iconNode:t,className:s("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),c),...n})});return r.displayName="".concat(e),r}},9769:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9687).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}},e=>{e.O(0,[9664,5324,122,587,18,7358],()=>e(e.s=2867)),_N_E=e.O()}]);