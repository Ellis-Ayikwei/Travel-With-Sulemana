(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7059],{1166:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9687).A)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},2203:(e,t,r)=>{"use strict";let a;r.d(t,{A:()=>i,O:()=>l});var s=r(7620);try{a=r(122)}catch(e){a={}}function i(){let e=null,t=null,r=null,i=null;try{a.useSignIn&&(e=a.useSignIn()),a.useSignOut&&(t=a.useSignOut()),a.useAuthUser&&(r=a.useAuthUser()),a.useIsAuthenticated&&(i=a.useIsAuthenticated())}catch(e){console.error("Error initializing react-auth-kit hooks",e)}let[l,n]=(0,s.useState)(null),[d,o]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=()=>{let e=(()=>{try{if(r&&"function"==typeof r)return r();{let e=localStorage.getItem("campusride_access_token");if(e)try{let t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(t).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join("")),a=JSON.parse(r);return{id:a.id,email:a.email,first_name:"",last_name:"",user_type:a.user_type}}catch(e){}}}catch(e){console.error("Error getting user",e)}return null})(),t=(()=>{try{if(i&&"function"==typeof i)return i();return!!localStorage.getItem("campusride_access_token")}catch(e){console.error("Error checking authentication",e)}return!1})();n(e),o(t)};e();let t=setInterval(e,2e3),a=()=>{e()};return window.addEventListener("storage",a),()=>{clearInterval(t),window.removeEventListener("storage",a)}},[r,i]),{user:l,isAuthenticated:d,isLoading:!1,login:(t,r,a)=>{localStorage.setItem("campusride_access_token",t),r&&localStorage.setItem("campusride_refresh_token",r);let s=a||null;if(!s)try{let e=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(e).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join("")),a=JSON.parse(r);s={id:a.id,email:a.email,first_name:"",last_name:"",user_type:a.user_type}}catch(e){console.error("Failed to decode token",e);return}if(e&&"function"==typeof e)try{e({token:t,expiresIn:604800,tokenType:"Bearer",authState:s})&&(n(s),o(!0))}catch(e){console.error("Failed to sign in with react-auth-kit",e)}else n(s),o(!0)},logout:()=>{if(localStorage.removeItem("campusride_access_token"),localStorage.removeItem("campusride_refresh_token"),t&&"function"==typeof t)try{t()}catch(e){console.error("Failed to sign out with react-auth-kit",e)}n(null),o(!1)},refreshUser:async()=>Promise.resolve()}}let l=a.AuthProvider||(e=>e.children)},2883:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>d,Rz:()=>l,c4:()=>i,pq:()=>n});var a=r(1208);let s=a.A.create({baseURL:"/api",headers:{"Content-Type":"application/json"},withCredentials:!0});function i(){return localStorage.getItem("campusride_access_token")}function l(e,t){localStorage.setItem("campusride_access_token",e),t&&localStorage.setItem("campusride_refresh_token",t)}s.interceptors.request.use(e=>{if(e.url&&e.url.startsWith("http")){let t=new URL(e.url);e.url=t.pathname}e.baseURL="/api";let t=i();return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,e=>{var t;return(null==(t=e.response)?void 0:t.status)===401&&(localStorage.removeItem("campusride_access_token"),localStorage.removeItem("campusride_refresh_token"),window.location.href="/auth/login"),Promise.reject(e)});let n={login:async(e,t)=>{let r=window.location.origin,s="".concat(r,"/api/auth/login");console.log("\uD83D\uDD35 Login API URL:",s),console.log("\uD83D\uDD35 Current origin:",r);let i=await a.A.post(s,{email:e,password:t},{headers:{"Content-Type":"application/json"}});return{access:i.data.access,refresh:i.data.refresh,user:i.data.user||{}}},register:async e=>{let t=window.location.origin;return(await a.A.post("".concat(t,"/api/auth/register"),e,{headers:{"Content-Type":"application/json"}})).data}},d=s},3094:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9687).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},4624:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9687).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},6840:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9687).A)("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]])},8517:(e,t,r)=>{Promise.resolve().then(r.bind(r,8865))},8865:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var a=r(4568),s=r(7620),i=r(7541),l=r(1166),n=r(9760),d=r(6840),o=r(4624),c=r(3094),u=r(9664),g=r.n(u),h=r(2883),x=r(2203);function m(){let e=(0,i.useRouter)(),{isAuthenticated:t,isLoading:r}=(0,x.A)(),[u,m]=(0,s.useState)(""),[y,p]=(0,s.useState)(""),[k,f]=(0,s.useState)(!1),[b,v]=(0,s.useState)(!1),[j,w]=(0,s.useState)(null),[N,A]=(0,s.useState)(""),[_,S]=(0,s.useState)("");if((0,s.useEffect)(()=>{r||t||e.push("/auth/login?from=".concat(encodeURIComponent("/book-ride")))},[t,r,e]),r||!t)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-950",children:(0,a.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:"Loading..."})});async function C(){if(!u||!y)return void S("Please enter both pickup and destination");f(!0),w(null),S("");try{w({distance:5,duration:"10-15 min",fare:10})}catch(s){var e,t,r,a;S((null==(t=s.response)||null==(e=t.data)?void 0:e.detail)||(null==(a=s.response)||null==(r=a.data)?void 0:r.message)||s.message||"Failed to estimate fare")}finally{f(!1)}}async function I(){if(!u||!y)return void S("Please enter both pickup and destination");v(!0),A(""),S("");try{let t=(await h.Ay.get("/auth/me")).data.id,r=await h.Ay.post("/rides",{rider_id:t,pickup_location:u,dropoff_location:y,fare:(null==j?void 0:j.fare)||10});A("Ride requested successfully! Ride ID: ".concat(r.data.id)),setTimeout(()=>{e.push("/ride-in-progress?id=".concat(r.data.id))},2e3)}catch(e){var t,r,a,s;S((null==(r=e.response)||null==(t=r.data)?void 0:t.detail)||(null==(s=e.response)||null==(a=s.data)?void 0:a.message)||e.message||"Failed to create ride request")}finally{v(!1)}}return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-black",children:[(0,a.jsx)("nav",{className:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(g(),{href:"/",className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Campus Ride"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(g(),{href:"/history",className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:"History"}),(0,a.jsx)(g(),{href:"/",className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:"Home"})]})]})})}),(0,a.jsx)("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-lg p-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Book a Ride"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"Enter your pickup and destination to get started"}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,a.jsx)(l.A,{className:"w-4 h-4 inline mr-1"}),"Pickup Location"]}),(0,a.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),placeholder:"e.g., Library, Main Gate, Dormitory Block A",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[(0,a.jsx)(l.A,{className:"w-4 h-4 inline mr-1"}),"Destination"]}),(0,a.jsx)("input",{type:"text",value:y,onChange:e=>p(e.target.value),placeholder:"e.g., Lecture Hall 3, Cafeteria, Sports Complex",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsx)("button",{onClick:C,disabled:!u||!y||k,className:"w-full px-6 py-3 bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white font-medium rounded-xl hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:k?"Calculating...":"Get Estimated Fare"}),j&&(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-6",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Ride Estimate"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[j.distance&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Distance"}),(0,a.jsxs)("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[j.distance.toFixed(1)," km"]})]}),j.duration&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Duration"}),(0,a.jsx)("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:j.duration})]}),j.fare&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Estimated Fare"}),(0,a.jsxs)("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["GHS ",j.fare.toFixed(2)]})]})]})]}),_&&(0,a.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4 text-red-700 dark:text-red-400",children:_}),N&&(0,a.jsx)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4 text-green-700 dark:text-green-400",children:N}),(0,a.jsx)("button",{onClick:I,disabled:!u||!y||b,className:"w-full px-6 py-4 bg-gray-900 dark:bg-white text-white dark:text-gray-900 font-semibold rounded-xl hover:bg-gray-800 dark:hover:bg-gray-100 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:b?"Requesting Ride...":(0,a.jsxs)(a.Fragment,{children:["Request Ride",(0,a.jsx)(n.A,{className:"w-5 h-5"})]})})]}),(0,a.jsxs)("div",{className:"mt-8 pt-8 border-t border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"What to Expect"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(d.A,{className:"w-5 h-5 text-gray-600 dark:text-gray-400 mt-1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:"Verified Drivers"}),(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"All drivers are campus-verified"})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(o.A,{className:"w-5 h-5 text-gray-600 dark:text-gray-400 mt-1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:"Quick Response"}),(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Average 10 min response time"})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(c.A,{className:"w-5 h-5 text-gray-600 dark:text-gray-400 mt-1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:"Transparent Pricing"}),(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Fares calculated by distance"})]})]})]})]})]})})]})}},9687:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(7620);let s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:l=24,strokeWidth:n=2,absoluteStrokeWidth:d,className:o="",children:c,iconNode:u,...g}=e;return(0,a.createElement)("svg",{ref:t,...i,width:l,height:l,stroke:r,strokeWidth:d?24*Number(n)/Number(l):n,className:s("lucide",o),...g},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),n=(e,t)=>{let r=(0,a.forwardRef)((r,i)=>{let{className:n,...d}=r;return(0,a.createElement)(l,{ref:i,iconNode:t,className:s("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),n),...d})});return r.displayName="".concat(e),r}},9760:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9687).A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])}},e=>{e.O(0,[9664,5324,122,587,18,7358],()=>e(e.s=8517)),_N_E=e.O()}]);